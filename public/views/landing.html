<!DOCTYPE html>
<html lang="en" class="no-js">

<head>




    <!-- Title and Icon -->

    <title>Yedaş Çağrı Merkezi</title>
    <!-- <link rel="shortcut icon" href="../images/logo.svg" /> -->
    <!-- <link rel="apple-touch-icon" href="../images/logo.svg" /> -->

    <!-- Meta Information -->

    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- https://ogp.me -->

    <meta property="og:type" content="app-webrtc" />

    <!--buraya sistemi kullanan kişinin logosu gelecek-->


    <!-- StyleSheet -->

    <!-- custom css -->
    <link rel="stylesheet" href="../css/landing.css" />
    <link rel="stylesheet" href="../css/bootstrapIconPack.css">

    <!-- bootstrap 5 css import -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
</head>

<body>
    <nav class="navbar text-info bg-light">
        <div class="container-fluid">
          <span class="navbar-brand mb-0 h1"> <img src="../images/favicon.ico" width="60px" height="25px" alt=""></span>
        </div>
      </nav>

    <div class="left">
        <div class="hover hover-9"></div>
        <div class="concept concept-eight">
        <h1 class="word">
            <div class="char" data-content="Y">Y</div>
            <div class="char" data-content="E">E</div>
            <div class="char" data-content="D">D</div>
            <div class="char" data-content="A">A</div>
            <div class="char" data-content="Ş">Ş</div>
        </h1>
        </div>
    </div>

    <div class="right">
        <!-- login area -->
        <div class="login-area" id="loginElement">
            <div class="login-area-insade">
                <!-- <div class="mb-3">
                      <label for="exampleInputEmail1" class="form-label">TC Kimlik numaranız</label>
                      <input type="text" class="form-control" id="exampleInputEmail1" aria-describedby="tcHelp">
                    </div>
                    <div class="mb-3">
                      <label for="exampleInputPassword1" class="form-label">Şifreniz</label>
                      <input type="password" class="form-control" id="exampleInputPassword1">
                    </div>
                    <div class="mb-3 form-check">
                      <input type="checkbox" class="form-check-input" id="exampleCheck1">
                      <label class="form-check-label" for="exampleCheck1">KVKK ve Aydınlatma metnini okudum, onaylıyorum.</label>
                    </div>
                    <button class="btn btn-success landingButtons">Giriş Yap</button>
                    <br>
                    <br>
                    <button onclick="registerShow()" class="btn btn-primary landingButtons">Kayıt Ol</button> -->

                <div class="mb-3">
                    <label for="tcKimlik" class="form-label">TC Kimlik numaranız</label>
                    <input type="text" class="form-control" id="tcKimlik" aria-describedby="tcHelp">
                </div>

                <div class="mb-3">
                    <label for="fullname" class="form-label">Adınız ve Soyadınız</label>
                    <!-- kişinin adı ve soyadı aynı zamanda roomName id'si ile oda adı olacaktır -->
                    <input type="text" class="form-control" id="fullname" aria-describedby="tcHelp">
                </div>

                <div class="mb-3">
                    <label for="phonenumber" class="form-label">Telefon numaranız</label>
                    <!-- kişinin adı ve soyadı aynı zamanda roomName id'si ile oda adı olacaktır -->
                    <input type="text" class="form-control" id="phonenumber" aria-describedby="tcHelp">
                </div>

                <div class="mb-3" hidden>
                    <label for="roomName" class="form-label">oda adı</label>
                    <!-- kişinin adı ve soyadı aynı zamanda roomName id'si ile oda adı olacaktır -->
                    <input type="text" class="form-control" id="roomName" aria-describedby="tcHelp">
                </div>


                <div class="mb-3">
                    <select class="form-select" aria-label="Default select example" id="callType">
                        <option selected>Çağrı nedeni seçiniz</option>
                        <option>Elektrik Arızası bildir</option>
                        <option>Sokak Aydınlatma Arızası bildir</option>
                        <option>Kaçak Kullanım ihbarı bildir</option>
                        <option>Öneri talep şikayet bildir</option>
                    </select>
                </div>

                <div class="mb-3 form-check">
                    <input type="checkbox" class="form-check-input" id="exampleCheck1">
                    <label class="form-check-label" for="exampleCheck1">KVKK ve Aydınlatma metnini okudum,
                        onaylıyorum.</label>
                </div>

                <p id="mesaiDisi" style="display: none; color: red;">Daha detaylı bilgi alabilmek için mesai saatleri içerisinde Canlı Destek Hattı'na ulaşmanızı rica ederiz. (Hafta içi günler 08:00 - 17:00)</p>

                <button class="btn btn-success landingButtons" id="joinRoomButton"
                    onclick="joinRoom()"><i class="bi bi-telephone-fill"></i> Arama Başlat</button>
            </div>
        </div>

        <!-- <div class="register-area" id="registerElement">
         <div class="register-area-insade">
                    <div class="mb-3">
                      <label for="exampleInputEmail1" class="form-label">TC Kimlik numaranız</label>
                      <input type="text" class="form-control" id="exampleInputEmail1" aria-describedby="tcHelp">
                    </div>

                    <div class="mb-3">
                        <label for="exampleInputEmail1" class="form-label">Adınız ve Soyadınız</label>
                        <input type="text" class="form-control" id="exampleInputEmail1" aria-describedby="tcHelp">
                    </div>

                    <div class="mb-3">
                        <label for="exampleInputEmail1" class="form-label">Telefon Numaranız</label>
                        <input type="text" class="form-control" id="exampleInputEmail1" aria-describedby="tcHelp">
                    </div>

                    <div class="mb-3">
                      <label for="exampleInputPassword1" class="form-label">Şifreniz</label>
                      <input type="password" class="form-control" id="exampleInputPassword1">
                    </div>

                    <div class="mb-3">
                        <label for="exampleInputPassword1" class="form-label">Şifre Tekrarı</label>
                        <input type="password" class="form-control" id="exampleInputPassword1">
                    </div>

                    <div class="mb-3 form-check">
                      <input type="checkbox" class="form-check-input" id="exampleCheck1">
                      <label class="form-check-label" for="exampleCheck1">KVKK ve Aydınlatma metnini okudum, onaylıyorum.</label>
                    </div>

                    <button class="btn btn-success landingButtons">Kayıt Ol</button>
                    <br>
                    <br>
                    <button onclick="loginShow()" class="btn btn-primary landingButtons">Zaten hesabınız var mı ? Giriş yap</button>
                </div> 
    </div>-->
    </div>

    <!-- custom js imports -->
    <!-- <script src="../js/landing_LoginOrRegisterSwitch.js"></script> -->
    <script defer src="../js/newRoom.js"></script>
    <!-- bootstrap 5 js imports -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>

    <!-- html in custom js -->

   <script>
        var simdi = new Date();
        simdi.toLocaleTimeString();
        var saat = simdi.getHours()
        // if(saat >= 17)
        // {
        //     document.getElementById('mesaiDisi').style.display = 'inline';
        //     document.getElementById('joinRoomButton').disabled = true
        // }
        // else if(saat < 8){
        //     document.getElementById('mesaiDisi').style.display = 'inline';
        //     document.getElementById('joinRoomButton').disabled = true
        // }
        // else{
        //    //boş
        // }
    </script>  

    <!-- join room -->
    <script>



        // eğer ENTER' a basarsa arama odasına katılacak
        document.getElementById('roomName').onkeyup = (e) => {
            if (e.keyCode === 13) {
                e.preventDefault();
                joinRoom();
            }
        };

        // eğer BUTTON' a basarsa arama odasına katılacak
        function joinRoom() {
            // vatandaş bilgilerini db'ye kaydet
            var vatandasTc = document.getElementById('tcKimlik').value; // vatandaş tc no
            var vatandasName = document.getElementById('fullname').value; // vatandaş tam adı soyadı
            var vatandasCallType = document.getElementById('callType').value; // vatandaş arama nedeni
            var vatandasPhonenumber = document.getElementById('phonenumber').value; // vatandaş telefon numarası
            var callLink = document.getElementById('roomName').value; // bağlantı linki

                sessionStorage.setItem('vatandasName', "AD : " + document.getElementById('fullname').value + " - TC : " + document.getElementById('tcKimlik').value + " - ARAMA NEDENİ : " + document.getElementById('callType').value); // vatandaşın adı ve soyadı
                localStorage.setItem('vatandasTc', vatandasTc); // vatandaşın tc si
                sessionStorage.setItem('vatandasPhone', vatandasPhonenumber); // vatandaşın telefon numarası
                sessionStorage.setItem('vatandasAramanedeni', vatandasCallType); // vatandaşın arama nedeni

               console.log('peer name ' + sessionStorage.getItem('vatandasName'));
         
                callLink = 'https://yedas-konferans.herokuapp.com/join/' + callLink; // temsılcı tarafından yonlendırılecek call lınk

                var myHeaders = new Headers();
                myHeaders.append("Content-Type", "application/x-www-form-urlencoded");
                var urlencoded = new URLSearchParams();
                urlencoded.append("tcKimlik", vatandasTc);
                urlencoded.append("fullName", vatandasName);
                urlencoded.append("phonenumber", vatandasPhonenumber);
                urlencoded.append("typeInfo", vatandasCallType);
                urlencoded.append("connectionLink", callLink);

                var requestOptions = {
                    method: 'POST',
                    headers: myHeaders,
                    body: urlencoded,
                    redirect: 'follow'
                };

                fetch("https://yedas-agent.herokuapp.com/api/customers/", requestOptions)
                    .then(response => response.text())
                    .then(result => console.log(result))
                    .catch(error => console.log(error));
           

            let roomName = document.getElementById('roomName').value;
            setTimeout(function(){
                window.location.href = '/join/' + roomName
             }, 2000);
           
        }
    </script>

    <!-- Tc control -->
    <script>

        var tcInput = document.getElementById('tcKimlik');

        tcInput.addEventListener('change', (event) => {

            var tcNo = document.getElementById('tcKimlik').value;

            if (tcNo.length < 11) {
                tcInput.style.color = 'red';
            }
            else if (tcNo.length > 11) {
                tcInput.style.color = 'red';
            }
            else {
                tcInput.style.color = 'green';
            }
        });

    </script>
</body>

</html>
